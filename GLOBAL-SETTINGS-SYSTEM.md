# 🌐 نظام الإعدادات العالمي المتكامل

## 🎯 الهدف من النظام
تم إنشاء نظام إعدادات عالمي شامل يطبق التغييرات مثل العملة واللغة والضريبة على النظام بالكامل، مما يضمن تجربة موحدة ومتسقة في جميع أجزاء التطبيق.

## ✅ المكونات المطبقة

### 🔧 **Context الإعدادات العالمية** (`SettingsContext`):
- **مكان الملف**: `src/contexts/settings-context.tsx`
- **الوظيفة**: إدارة مركزية لجميع الإعدادات
- **التخزين**: localStorage مع تحديث فوري
- **التطبيق**: على جميع أجزاء النظام

### 📚 **مكتبة الأدوات العالمية** (`global-utils.ts`):
- **مكان الملف**: `src/lib/global-utils.ts`
- **الوظيفة**: وظائف تنسيق تستخدم الإعدادات العالمية
- **الميزات**: تنسيق العملة، التاريخ، الأرقام حسب الإعدادات

### 🎨 **تطبيق على جميع الصفحات**:
- **لوحة التحكم**: تنسيق العملة والأرقام
- **المصروفات**: تنسيق العملة والتاريخ والضريبة
- **الفواتير**: تنسيق العملة والتاريخ والحالات
- **الإعدادات**: إدارة مركزية للتغييرات

## 🔄 آلية العمل

### 📊 **تدفق البيانات**:
```
صفحة الإعدادات → SettingsContext → localStorage → جميع الصفحات
```

### 🎯 **التطبيق الفوري**:
1. **تغيير في الإعدادات** → تحديث Context فوري
2. **Context يحدث localStorage** → حفظ دائم
3. **جميع المكونات تتلقى التحديث** → تطبيق فوري
4. **إعادة تنسيق جميع القيم** → تجربة موحدة

## 🌟 الميزات المطبقة

### 💰 **تنسيق العملة العالمي**:
- **التطبيق**: جميع المبالغ في النظام
- **التحكم**: نوع العملة ورمزها من الإعدادات
- **التنسيق**: حسب اللغة المختارة (عربي/إنجليزي)
- **المثال**: 
  - عربي: `1,234.56 ر.س`
  - إنجليزي: `$ 1,234.56`

### 🗓️ **تنسيق التاريخ العالمي**:
- **التطبيق**: جميع التواريخ في النظام
- **التحكم**: حسب اللغة المختارة
- **التنسيق**: 
  - عربي: تقويم هجري/ميلادي
  - إنجليزي: تقويم ميلادي
- **المثال**:
  - عربي: `١٥ ديسمبر ٢٠٢٤`
  - إنجليزي: `December 15, 2024`

### 🧮 **حساب الضريبة العالمي**:
- **التطبيق**: جميع الفواتير والحسابات
- **التحكم**: معدل الضريبة من الإعدادات
- **التحديث**: فوري عند تغيير المعدل
- **المثال**: تغيير من 15% إلى 10% يطبق على كل شيء

### 🌍 **دعم اللغات**:
- **العربية**: اتجاه RTL، تنسيق عربي، أرقام عربية
- **الإنجليزية**: اتجاه LTR، تنسيق إنجليزي، أرقام إنجليزية
- **التبديل**: فوري بدون إعادة تحميل الصفحة

## 🎯 الصفحات المحدثة

### 📊 **لوحة التحكم** (`/dashboard`):
- **StatsCard**: تستخدم formatCurrency العالمي
- **الإحصائيات**: تتحدث فوراً مع تغيير العملة
- **الرسوم البيانية**: تنسيق الأرقام حسب اللغة

### 💰 **صفحة المصروفات** (`/expenses`):
- **قائمة المصروفات**: تنسيق العملة والتاريخ
- **الإحصائيات**: إجمالي المصروفات بالعملة المختارة
- **التقارير**: تنسيق شامل حسب الإعدادات
- **إدارة الموظفين**: رواتب بالعملة المختارة

### 📄 **صفحة الفواتير** (`/invoices`):
- **قائمة الفواتير**: تنسيق العملة والتاريخ
- **الإحصائيات**: مبالغ بالعملة المختارة
- **حساب الضريبة**: حسب المعدل المحدد
- **حالات الفواتير**: نصوص حسب اللغة

### ⚙️ **صفحة الإعدادات** (`/settings`):
- **إدارة مركزية**: لجميع الإعدادات العالمية
- **تطبيق فوري**: التغييرات تظهر مباشرة
- **حفظ تلقائي**: في localStorage
- **نسخ احتياطي**: للإعدادات الكاملة

## 🔧 الـ Hooks المتاحة

### 🎯 **useSettings()** - الـ Hook الرئيسي:
```typescript
const {
  companySettings,
  userSettings,
  invoiceSettings,
  updateCompanySettings,
  updateUserSettings,
  updateInvoiceSettings,
  formatCurrency,
  formatDate,
  calculateTax,
  calculateTotal,
  isLoading,
  lastSaved,
  saveAllSettings
} = useSettings()
```

### 💰 **useFormatting()** - للتنسيق فقط:
```typescript
const { 
  formatCurrency, 
  formatDate, 
  calculateTax, 
  calculateTotal 
} = useFormatting()
```

### 🏢 **useCompanySettings()** - لإعدادات الشركة:
```typescript
const { 
  companySettings, 
  updateCompanySettings 
} = useCompanySettings()
```

### 🌍 **useLanguage()** - للغة والاتجاه:
```typescript
const { 
  language, 
  isRTL, 
  direction 
} = useLanguage()
```

## 🎨 أمثلة الاستخدام

### 💰 **تنسيق العملة**:
```typescript
// في أي مكون
const { formatCurrency } = useFormatting()

// الاستخدام
<div>{formatCurrency(1234.56)}</div>
// النتيجة: "1,234.56 ر.س" أو "$ 1,234.56"
```

### 🗓️ **تنسيق التاريخ**:
```typescript
// في أي مكون
const { formatDate } = useFormatting()

// الاستخدام
<div>{formatDate(new Date())}</div>
// النتيجة: "١٥ ديسمبر ٢٠٢٤" أو "December 15, 2024"
```

### 🧮 **حساب الضريبة**:
```typescript
// في أي مكون
const { calculateTax, calculateTotal } = useFormatting()

const amount = 1000
const tax = calculateTax(amount) // حسب معدل الضريبة المحدد
const total = calculateTotal(amount) // المبلغ + الضريبة
```

### ⚙️ **تحديث الإعدادات**:
```typescript
// في صفحة الإعدادات
const { updateCompanySettings } = useSettings()

// تغيير العملة
updateCompanySettings({
  currency: 'دولار أمريكي',
  currency_symbol: '$'
})

// تغيير معدل الضريبة
updateCompanySettings({
  tax_rate: 10
})

// تغيير اللغة
updateCompanySettings({
  language: 'en'
})
```

## 🔄 التحديث التلقائي

### ✅ **عند تغيير العملة**:
1. تحديث فوري في Context
2. حفظ في localStorage
3. إعادة تنسيق جميع المبالغ في النظام
4. تحديث جميع الإحصائيات والتقارير

### ✅ **عند تغيير اللغة**:
1. تحديث فوري في Context
2. تغيير اتجاه النص (RTL/LTR)
3. إعادة تنسيق التواريخ والأرقام
4. تحديث نصوص الحالات والرسائل

### ✅ **عند تغيير معدل الضريبة**:
1. تحديث فوري في Context
2. إعادة حساب جميع الفواتير
3. تحديث الإحصائيات المالية
4. تطبيق على الفواتير الجديدة

## 🎊 النتيجة النهائية

### ✨ **نظام إعدادات عالمي متكامل**:
- **تطبيق شامل**: على جميع أجزاء النظام ✅
- **تحديث فوري**: بدون إعادة تحميل الصفحة ✅
- **حفظ دائم**: في localStorage ✅
- **تجربة موحدة**: في جميع الصفحات ✅
- **دعم متعدد اللغات**: عربي وإنجليزي ✅
- **تنسيق ذكي**: حسب الإعدادات المختارة ✅

### 🚀 **مزايا النظام**:
- **سهولة الإدارة**: تغيير واحد يطبق على كل شيء
- **الاتساق**: تنسيق موحد في جميع أنحاء النظام
- **المرونة**: دعم عملات ولغات متعددة
- **الأداء**: تحديث فوري بدون تأخير
- **الموثوقية**: حفظ تلقائي ونسخ احتياطي

---

**🎉 تم تطبيق نظام الإعدادات العالمي بنجاح!**

**✅ جميع التغييرات تطبق على النظام كاملاً فوراً!**

**💰 العملة والضريبة واللغة تعمل عالمياً!**

**🔄 تحديث تلقائي لجميع الصفحات والمكونات!**

**🌍 دعم كامل للغة العربية والإنجليزية!**

**🚀 النظام جاهز للاستخدام الاحترافي العالمي!**

الآن يمكنك تغيير أي إعداد في صفحة الإعدادات وسترى التأثير فوراً في جميع أنحاء النظام!
